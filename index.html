<!doctype html>
<html lang="es">
<head>
  <!-- Codificación estándar -->
  <meta charset="utf-8">

  <!-- Viewport para móviles; evita zoom manual (UX tipo app). 'viewport-fit=cover' permite usar area segura en iOS. -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no">

  <!-- Color del UI del navegador (Chrome/Android, Windows, etc.) -->
  <meta name="theme-color" content="#007bff">

  <!-- Título de la app -->
  <title>Todo Terreno PRO — Bootstrap 4 + jQuery</title>

  <!-- Manifest PWA: nombre, íconos, scope y comportamiento de instalación -->
  <link rel="manifest" href="./manifest.webmanifest?v=v5.6.1">

  <!-- Favicon/ícono base (también útil para splash en algunas plataformas) -->
  <link rel="icon" href="./assets/icons/icon-192.png" sizes="192x192">
  <link rel="apple-touch-icon" href="./assets/icons/icon-192.png">

  <!-- CSS de Bootstrap 4.6 (solo estilos, bundle JS va al final) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

  <!-- Estilos propios de la app (versionados por querystring) -->
  <link href="./css/app.css?v=v5.6.1-r0" rel="stylesheet">

  <!-- Evita cachear este HTML (útil durante desarrollo/QA) -->
  <meta http-equiv="Cache-Control" content="no-store, max-age=0, must-revalidate">

  <!-- Utilidad mínima para íconos inline en los botones del header -->
  <style>
    .icon-img { width: 20px; height: 20px; vertical-align: -3px; }
  </style>
</head>

<body class="app-body">
  <!--
    HEADER FIJO (fixed-top)
    - Incluye logo/título a la izquierda y acciones rápidas a la derecha.
    - Botones: Ajustes (engranaje) y Cerrar sesión (salir).
  -->
  <header class="app-header navbar navbar-light bg-white border-bottom fixed-top">
    <div class="container-fluid align-items-center d-flex justify-content-between">
      <div class="d-flex align-items-center">
        <!-- Logotipo redondeado -->
        <img src="./assets/icons/icon-192.png" class="rounded" width="28" height="28" alt="">
        <strong class="ml-2">Todo Terreno PRO</strong>
      </div>

      <!-- Acciones de usuario en la barra superior -->
      <div class="d-flex align-items-center">
        <!-- Botón: Sesión (muestra login o logout según estado) -->
        <button class="btn btn-link text-decoration-none" id="btn-auth" title="Iniciar sesión">
          <img class="icon-img" id="icon-auth" alt="Sesión" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBQcm8gNi43LjIgYnkgQGZvbnRhd2Vzb21lIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20gTGljZW5zZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tL2xpY2Vuc2UgKENvbW1lcmNpYWwgTGljZW5zZSkgQ29weXJpZ2h0IDIwMjUgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTMxOS4yIDI1Ny44Yy41LS41IC44LTEuMSAuOC0xLjhzLS4zLTEuNC0uOC0xLjhMMTg3LjMgMTI5LjhjLTEuMi0xLjItMi45LTEuOC00LjYtMS44Yy0zLjcgMC02LjcgMy02LjcgNi43bDAgNTcuM2MwIDguOC03LjIgMTYtMTYgMTZMNDAgMjA4Yy00LjQgMC04IDMuNi04IDhsMCA4MGMwIDQuNCAzLjYgOCA4IDhsMTIwIDBjOC44IDAgMTYgNy4yIDE2IDE2bDAgNTcuM2MwIDMuNyAzIDYuNyA2LjcgNi43YzEuNyAwIDMuMy0uNiA0LjYtMS44TDMxOS4yIDI1Ny44ek0zNTIgMjU2YzAgOS41LTMuOSAxOC42LTEwLjggMjUuMUwyMDkuMiA0MDUuNWMtNy4yIDYuOC0xNi43IDEwLjUtMjYuNSAxMC41Yy0yMS40IDAtMzguNy0xNy4zLTM4LjctMzguN2wwLTQxLjNMNDAgMzM2Yy0yMi4xIDAtNDAtMTcuOS00MC00MGwwLTgwYzAtMjIuMSAxNy45LTQwIDQwLTQwbDEwNCAwIDAtNDEuM2MwLTIxLjQgMTcuMy0zOC43IDM4LjctMzguN2M5LjkgMCAxOS4zIDMuOCAyNi41IDEwLjVMMzQxLjIgMjMwLjljNi45IDYuNSAxMC44IDE1LjYgMTAuOCAyNS4xek0zMzYgNDQ4bDk2IDBjMjYuNSAwIDQ4LTIxLjUgNDgtNDhsMC0yODhjMC0yNi41LTIxLjUtNDgtNDgtNDhsLTk2IDBjLTguOCAwLTE2LTcuMi0xNi0xNnM3LjItMTYgMTYtMTZsOTYgMGM0NC4yIDAgODAgMzUuOCA4MCA4MGwwIDI4OGMwIDQ0LjItMzUuOCA4MC04MCA4MGwtOTYgMGMtOC44IDAtMTYtNy4yLTE2LTE2czcuMi0xNiAxNi0xNnoiLz48L3N2Zz4=">
        </button>
      </div>
    </div>
  </header>

  <!--
    BREADCRUMBS (sticky-top)
    - Muestra la ruta de navegación; el contenido se inyecta desde main.js en #breadcrumbs
    - Se posiciona justo debajo del header fijo
  -->
  <nav class="app-bc border-bottom bg-white sticky-top">
    <div class="container-fluid">
      <ol class="breadcrumb mb-0 py-2 px-0" id="breadcrumbs"></ol>
    </div>
  </nav>

  <!--
    MAIN (contenedor donde cada vista renderiza su HTML)
    - #app-main es gestionado por el router hash (main.js)
    - tabindex="-1" permite manejar focus programático para accesibilidad
  -->
  <main class="app-main container-fluid" id="app-main" role="main" tabindex="-1"></main>

  <!--
    FOOTER FIJO (fixed-bottom)
    - Chips informativos: estado de conexión, pendientes, sincronizados
    - Botón "Sincronizar" para forzar tryProcessQueue()
  -->
  <footer class="app-footer fixed-bottom border-top bg-white">
    <div class="container-fluid py-2">
      <div class="d-flex align-items-center flex-wrap w-100">
        <span class="badge badge-pill badge-success" id="chip-online">Online</span>
        <a href="#/pending" class="ml-2 text-decoration-none"><span class="badge badge-pill badge-warning" id="chip-pending">Pend: 0</span></a>
        <a href="#/synced" class="ml-2 text-decoration-none"><span class="badge badge-pill badge-primary" id="chip-synced">Sync: 0</span></a>
        <button class="btn btn-sm btn-primary ml-auto" id="btn-sync-footer">Sincronizar</button>
      </div>
    </div>
  </footer>

  <!-- Dependencias JS (CDN oficiales) -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

  <!-- Código de la app (versionado por querystring) -->
  <script src="./js/main.js?v=v5.6.1-r0"></script>

  <!-- Registro de Service Worker
       - Se hace en 'load' para no bloquear el first paint
       - scope './' asegura que controle todas las rutas relativas del sitio
       - catch silencioso para evitar alertas en navegadores sin soporte -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () =>
        navigator.serviceWorker.register('./sw.js?v=v5.6.1', { scope: './' }).catch(() => {})
      );
    }
  </script>
</body>
</html>
